# サイズバリエーション追加

YATAのメニューに「サイズ」バリエーションを追加するための要件定義・調査ドキュメントです。

## 目的
- ユーザーが商品に対して"S"、"M"、"L"などのサイズオプションを追加・選択できるようにする。

## アイデア出し、影響範囲など包括的ドラフト

- ドメインモデルの変更が必要。

- 注文管理画面では、collapse表示を行い、クリックで展開？
  - 展開後はサイズごとに変更可能？

- `MenuItem`に`sizes`フィールドを追加し、利用可能なサイズのリストを保持する？

- メニューとして、内部的な扱いはどうするか？
  - 売り上げ分析機能などでは別商品として判定できた方が良い
  - ただし、在庫管理やメニュー(特にレシピ)管理、注文時には同一商品として扱いたい
    - → `MenuItem`は同一商品として扱い、売り上げ分析では`MenuItemVariant`のような別エンティティを導入してサイズごとに区別する？
      - -> ということは、csvエクスポートなどもサイズごとに分ける必要がある？
  - `MenuItem`に`sizes`フィールドを追加し、利用可能なサイズのリストを保持する？
    - 例えば、`sizes: ['S', 'M', 'L']`のように
    - ただし、サイズごとに価格が異なる場合もあるため、価格情報も含める必要がある
      - 例: `sizes: [{'size': 'S', 'price': 500}, {'size': 'M', 'price': 700}, {'size': 'L', 'price': 900}]`
  - 注文時には、選択されたサイズに基づいて価格を計算するロジックが必要
    - sizesフィールドの有無判定 -> クリックされたサイズを、、、
      - 例外的な判定が必要になるのがいやだ
        - いや、ならば、全てのメニューに対してsizesフィールドを持たせて、、、
          - 例えば、既存のメニューにはデフォルトサイズを設定しておく
            - 例: `sizes: [{'size': 'Default', 'price': 500}]`
            - これならば、全てのメニューに対して一貫したロジックで価格計算が可能？
            - ただ、どうせデフォルトサイズしか存在しない -> サイズ選択用のUIを使う必要がないかどうかを判定する必要がある。
              - いや、UI側でsizesフィールドの長さを見て、1以上ならばサイズ選択UIを表示するようにすれば良い？
                - いや、UI側でsizesフィールドの長さを見て、1以上ならばサイズ選択UIを表示するようにすれば良い？

  ## 結局？（実装方針まとめ）

  - すべての`MenuItem`に`sizes`フィールド（サイズ・価格のリスト）を持たせる。
    - 既存メニューは `sizes: [{'size': 'Default', 'price': 500}]` のようにデフォルト値を設定。
  - サイズごとに価格を持たせることで、価格計算ロジックを一元化。
  - UI側は`sizes`の要素数が1より多い場合のみサイズ選択UIを表示。
  - 売上分析やCSVエクスポート等、サイズごとに区別したい場合は`MenuItemVariant`等のエンティティで対応。
  - 在庫・レシピ・注文管理は`MenuItem`単位で扱い、サイズは属性として利用。


