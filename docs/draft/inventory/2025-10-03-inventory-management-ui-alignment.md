# 在庫管理ページ UI 再設計メモ (2025-10-03)

## 背景
- 現在の在庫管理ページは旧モックからの流用が多く、最新モック（添付）と視覚的・操作的に乖離している。
- 既存の YATA コンポーネント群を活かしつつ、モックに近い情報構造とデザインを再現する方針をまとめる。

## 現行実装の概要
- `InventoryManagementPage` 配下に以下のセクションが存在。
  - `_HeaderStats`: カスタムカード `_OverviewStatCard` を4枚 Wrap で配置。
  - ステータスフィルタ: `YataSectionCard` 内で `_StatusPill` を並列表示。
  - `_ControlsRow`: 検索フィールドと操作ボタン 2 種。
  - `_CategorySidebar`: 320px 固定幅でカテゴリ一覧を `ListView` 表示。
  - `_InventoryTable`: `YataSectionCard` + `YataDataTable` による一覧と一括操作。
- レイアウトは 1080px 以上でサイドバー＋メインの2カラム、それ以下で縦積み。
- 色使いはソフトトーン中心で、強調度が全体的に弱い。

## モック UI のキーポイント
- ヒーローカード: 4枚が等幅で並び、背景全体が状態色（青/緑/黄/赤）の淡い塗り。数値が大きく、単位は小さめに右下揃え。
- ステータスカード: タイトル・説明文・ステータスピルのセットが 1 カード内に収まり、中央寄せで視線誘導。
- カテゴリパネル: カード内にカテゴリごとのステータスバッジをまとめ、ホバー/選択状態がはっきりわかるスタイル。
- テーブルカード: 「未適用差分」などのメタ情報、アクションボタンがカード上部に揃って表示される。
- 全体余白: セクション間は一定 (約 24px) に統一され、カード内のパディングも 24px が基本。
- デザインアクセント: アイコンは輪郭線で統一し、角丸は medium〜large を使い分け。影はごく浅い。

## 差異の詳細
### レイアウト構造
- 現行: Wrap で横幅が決まるため、カードがバラバラの幅になる／センタリングされない。
- モック: 各セクションがカード単位で整列。特にトップカードはグリッド状に等幅配置。

### コンポーネントレベル
- `_OverviewStatCard` は独自実装で、`YataStatCard` が持つ標準スタイルを活用していない。
- カテゴリ一覧: `YataStatusBadge` の組み合わせやアイコン／トグルの視覚強調が不足。
- テーブルカード内のアクション群が複数箇所に分散し、利用フローが分かりづらい。

### ビジュアルデザイン
- 色: 状態色の使い方が控えめで、注意／危険の緊張感が伝わりにくい。
- タイポグラフィ: 数値の強弱が乏しく、数値と単位の対比が広報されていない。
- スペーシング: チップ間隔やセクション間のマージンが統一されず、リズムが崩れている。

### インタラクション / レスポンシブ
- ブレークポイントは 1080px のみで、モックが意識する 960px 前後での再構成が未対応。
- サイドバーを折りたたむ挙動がなく、モバイルではカード同士の層が重く感じる。

## 改善提案
### 1. 既存コンポーネントを活用した短期対応
- `_OverviewStatCard` → `YataStatCard` へ差し替え。`backgroundColor` を状態色にカスタマイズし、`suffix` に単位用テキストを配置。
- `Wrap` を `LayoutBuilder` + `IntrinsicHeight` または `GridView.extent` に変更し、常に 2 or 4 カラムで揃うよう制御。
- `_CategorySidebar` のカテゴリ行を `YataSectionCard` 内で `YataStatusBadge` の組み合わせに置換し、選択状態は `YataColorTokens.primarySoft` で強調。
- `_ControlsRow` は検索専用にし、テーブル上部のアクション `Wrap` に「再取得」「表示分適用」「在庫追加」などを集約。
- `_StatusPill` を背景: `YataColorTokens.*Soft`、文字色: `YataColorTokens.*` に統一し、パディング・角丸をトークン値に合わせる。

### 2. デザイン微調整
- トップカードのアイコンサイズを 32px 程度に上げ、色も状態色に統一。
- セクションタイトルに `YataTypographyTokens.titleLarge` を使用し、サブタイトルは `bodyMedium` で明度 60% の色を適用。
- カード外枠の影を `YataElevationTokens.level1` に統一し、視覚階層を明確化。
- 余白は `YataSpacingTokens.lg` をセクション間、`cardPadding` をカード内の基準に。チップやバッジの間隔は `sm` を標準とする。

### 3. レスポンシブ戦略
- 1280px+: サイドバー + メインの 2 カラム (現在と同様)。
- 960–1279px: サイドバーをメイン下に移動し、カードを 2 カラムグリッドで再配置。
- 0–959px: サイドバーを `ExpansionTile` などで折りたたみ式にし、ヒーローカードは横スクロール (SingleChildScrollView) で表示。

## 次のステップ
1. 上記を踏まえた UI リファクタリングタスクを作成し、`inventory_management_page.dart` の該当コンポーネントを再構築。
2. 状態色のバリエーション追加や `YataStatCard` のカラーバリエーション拡張が必要なら、`shared/components` 配下でオプションを検討。
3. 実装後に `flutter analyze` と主要ユニットテストを実行して回帰確認。
4. モバイル向けのスクリーンショットを取得し、デザインレビューを設定。

## メモ
- 既存コードに手を入れる際はコンポーネント単位で分割し、`widgets/` 以下にカードやサイドバーを切り出すと可読性が向上する。
- モックと完全一致する必要はなく、YATAらしさを維持しながら視覚的階層を整えることを重視する。
