# 注文画面メニューカード高さ調整メモ（2025-10-03）

## 背景
- 2025-10-02のパフォーマンス改善でメニュー一覧を `GridView.builder` 化したが、`childAspectRatio` ベースの高さ推定を 120px で固定していた。
- 実際の `YataMenuItemTile` はテキスト量に応じて80px前後で収まる設計のため、1カラム表示時に縦方向へ過剰な余白が発生。スクリーンショットでも大きく間延びして見える状態となった。

## 現象
- `OrderManagementPage` のメニューカードが縦長化し、1列/2列表示いずれでも上下に30〜80px程度の無駄スペースが生じる。
- 触覚面では問題ないものの、一覧が一画面に収まらずスクロール回数が増加し UX が低下する。

## 原因
- `childAspectRatio` の計算を簡易的に「`itemWidth / 120`」としたため、グリッドによる高さ正規化が実際のタイル高さと乖離した。
- タイルの高さ算出を行うロジックがなく、タイトル行数やステッパーの最小高さを考慮していなかった。

## 対応方針
- `SliverGridDelegateWithFixedCrossAxisCount` の `mainAxisExtent` を使用して、タイルごとに一定の高さを直接指定する。
- テーマのタイポグラフィトークンとパディング値からタイル必要高さを推定する関数を導入し、320px 未満の横幅ではタイトル2行を想定した余裕を確保する。
- 推定高さは `max(textHeight, trailingHeight, 92px)` とし、ステッパー/2行タイトルのどちらでもレイアウト崩れないようにする。

## フォローアップ項目
- 3カラム表示時（幅 ~280px）の文字折り返しを実機で確認し、2行タイトルでも余白が過剰にならないかを QA で再確認する。
- メニュー名が極端に長い場合は最大3行まで許容する必要があるかをデザイナーと調整。必要であれば高さ推定ロジックに上限行数のパラメータを追加する。
- 今回の変更で匿名関数の描画コストが増えないことを確認するため、`flutter run --profile` でのパフォーマンスサンプル取得を検討する。
