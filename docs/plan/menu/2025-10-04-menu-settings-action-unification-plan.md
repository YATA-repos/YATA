# メニュー設定導線統一計画（2025-10-04）

## 背景
- `Menu-Bugfix-1` で指摘されたとおり、メニュー管理ページだけが設定導線を中央ナビゲーションの一項目として配置している。
- 在庫管理・注文履歴など他ページでは `YataAppTopBar` の `trailing` アクションに設定ボタンを集約しており、ユーザは右上から設定へ遷移できる前提になっている。
- メニュー画面では右上に設定アイコンが存在しないため、デバイスや画面幅によっては設定導線がスクロールに隠れたり、視覚的一貫性が崩れている。

## 現状整理
| 画面 | ナビゲーション構成 | 設定導線の実装 | 関連ソース |
| --- | --- | --- | --- |
| 在庫管理 | 中央ナビ: 注文/注文状況/履歴/在庫/メニュー/売上分析 | `trailing` に `YataIconButton(Icons.settings)` | `lib/features/inventory/presentation/pages/inventory_management_page.dart` |
| 注文状況 / 履歴 | 同上 | `trailing` に設定ボタン＋更新ボタン | `lib/features/order/presentation/pages/order_status_page.dart` 他 |
| メニュー管理 | 中央ナビ: 注文/注文状況/履歴/在庫/メニュー/売上分析/設定 | `trailing` 未使用、設定はナビ項目として追加 | `lib/features/menu/presentation/pages/menu_management_page.dart` |

- `YataAppTopBar` は右端アクションを `trailing` スロットにまとめて表示するため、ここを活用しないと共通レイアウトが機能しない。
- メニュー管理ヘッダー（`MenuManagementHeader`）側では `在庫状況を再取得` ボタンなど独自アクションを提供しているが、設定導線がここにないこと自体は問題無し。

## ゴール
- メニュー管理ページを含む全ページで、設定導線が右上アクション領域に統一されている。
- ナビゲーション中央部から設定項目を除外し、他ページと同じ並び順・スタイルになる。
- 画面幅 1240px 以上／未満のレイアウト切り替え時、ヘッダが崩れずにアクションボタンが表示される。

## 対応方針
1. **ナビ項目の整理**: `MenuManagementPage` の `YataAppTopBar` に渡している `navItems` から設定項目を削除し、既存ページと同じ順序（注文 → 注文状況 → 履歴 → 在庫管理 → メニュー管理 → 売上分析）を維持する。
2. **右上アクションの追加**: `trailing` に `YataIconButton` を新設し、`SettingsPage.routeName` への遷移を担保する。アイコン・ツールチップ文言は在庫管理ページと揃える。
3. **追加アクションの検討**: メニュー画面固有の更新導線（在庫再取得ボタンなど）がヘッダーに存在するため、トップバーには設定導線のみ配置する。将来的な再利用を視野に、必要なら別タスクで共通化を検討する。
4. **コード整合性確認**: `YataIconButton` を利用するための必要インポートがそろっているか確認し、`flutter analyze` で未使用インポートが発生しないよう整理する。

## 実装タスク
1. `menu_management_page.dart` の `YataAppTopBar` 構成を更新し、設定 `YataNavItem` を削除。
2. 同ファイルで `trailing` プロパティを追加し、`YataIconButton(Icons.settings)` を設定。`tooltip` は「設定」。
3. 追加する `YataIconButton` に合わせて `SettingsPage` のインポート位置を調整（既存の `navItems` から削除するため不要になる場合は入れ替え）。
4. UI レイアウト崩れがないか、以下のブレークポイントで確認（DevTools の Device Frames を想定）:
   - 1440px（デスクトップ）
   - 1024px（タブレット横）
   - 900px（詳細パネルがモーダル切り替えになる閾値）
   - 768px（タブレット縦）

## 影響範囲
- メニュー管理ページのナビゲーションバー表示
- 画面上部のレイアウト（`YataAppTopBar` の `trailing` 表示幅）
- `SettingsPage.routeName` への遷移導線（機能自体は既存と同じ）

## 検証観点
- `flutter analyze` を実行し、未使用インポートやフォーマット崩れが出ていないか確認。
- 実機またはエミュレータで `/menu` を開き、右上に設定アイコンが表示され、タップで設定画面へ遷移できること。
- 中央ナビゲーションを左右スクロールした際、設定項目が無くなっていることを目視確認。
- ダークモード／ライトモード双方で `YataIconButton` のコントラストに問題が無いか簡易確認。

## リスクと対応
| リスク | 対応策 |
| --- | --- |
| トップバーの横幅が不足し、`trailing` 領域が折り返す | ヘッダーアクションを 1 つに限定し、必要であれば `YataAppTopBar` の余白トークンを見直す（今回は折り返し想定無し）。 |
| 設定ボタン移動により既存ユーザが戸惑う | 他ページと同じ配置になるため、むしろ学習コストが下がる。リリースノートで導線統一を周知。 |
| 将来的に別アクションを追加する際に配置が煩雑になる | `trailing` を配列で管理しているため、拡張は既存ページと同様のパターンで対応可能。 |

## フォローアップ候補
- メニュー管理ページにもトップバー更新ボタンを設けるべきか検討（`MenuManagementHeader` との二重導線を避ける判断が必要）。
- トップバーのナビゲーションラベルを `GoRouter` の定数に統一する改善タスク（既存コードのハードコーディングを解消）。
