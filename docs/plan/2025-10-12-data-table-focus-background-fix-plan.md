# YataDataTable フォーカス時背景修正計画（2025-10-12）

## 背景
- 在庫管理画面などで使用している `YataDataTable` にて、行内のステッパーやテキストフィールドへフォーカスすると行背景が濃い灰色に変化する不具合を確認。
- フォーカス時の行背景が暗くなるため、テキストやボタンの視認性が大きく低下し、操作性にも影響が出ている。
- 調査結果は `docs/draft/inventory_table_focus_background_analysis.md` に記録済み。

## 解決方針
1. `DataTableThemeData.dataRowColor` の `WidgetState.focused`（必要に応じて `pressed` や `dragged` など）に対し、既定色ではなく透過背景またはアクセシビリティに配慮した専用色を返すよう更新する。
2. フォーカス可視性を確保するため、必要なら別途アウトライン等でフォーカスを示す仕組みを検討する。
3. `YataDataTable` を利用している代表画面（在庫管理／メニュー管理等）で表示崩れが起きないことを確認する。

## タスク
1. **テーマ更新**
   - `lib/shared/components/data_display/data_table.dart` の `dataRowColor` 設定を修正し、`WidgetState.focused` でも `Colors.transparent`（あるいは設計上の適切な色）を返す。
   - 選択・ホバー状態との競合を避けるため、状態優先順位を見直し必要ならコメントを追記。
2. **フォーカススタイル検討**
   - UI/UX の観点でフォーカスの視認性が必要か確認し、必要なら `Focus` や `OutlineInputBorder` 等で控えめな輪郭表示を追加。
   - 追加する場合は色や太さをデザインガイドに合わせる。
3. **利用箇所の検証**
   - 在庫管理画面のテーブルでフォーカス時に背景が過度に暗くならないことを目視確認。
   - 他の `YataDataTable` 利用画面（例: メニュー管理）もスポットチェック。
4. **回帰防止**
   - 必要ならフォーカス時背景を検証する Widget テストを追加検討。
   - 変更内容を `CHANGELOG` または該当ドキュメントへ記載検討。

## 検証計画
- `flutter analyze` を実行して静的解析エラーがないことを確認。
- 在庫管理画面・メニュー管理画面を起動し、テーブル内のインタラクティブ要素へフォーカスして背景を確認。

## リスクと留意点
- フォーカス背景を完全に透明にするとキーボード操作時のフォーカスが見えづらくなる可能性あり → アクセシビリティ観点で代替指標を検討。
- `YataDataTable` が他画面でも使われているため、想定外の配色変化が起きていないかチーム確認を推奨。
