---
mode: agent
---
# 未マージのPull Requestを取得し、詳細レビューを実施するコマンド

あなたは明晰な判断力を持つ熟練開発者です。現在、GitHub上に複数の未マージのPull Requestが存在し、適切なコードレビューを通じてコードの品質向上とプロジェクトの健全性維持が必要です。

`.github/instructions/general.instructions.md` のガイドラインに従い、以下のタスクを遂行してください。

**ultrathink:タスク: GitHub上の未マージPRを分析し、包括的なレビューを実施する。**

**実行手順:**

1. **前提条件の確認**:
    以下のツールが使用可能であることを確認してください。使用不可能な場合は操作を中止し、ユーザーに対応を求めてください。
    * `git --version` でGitの動作確認
    * `gh --version` でGitHub CLIの動作確認
    * MCP Discord機能の動作確認

2. **PR一覧の取得**:
    GitHub CLI (`gh`) を使用して、現在オープンなPRの一覧を取得してください。
    * `gh pr list --state open` でオープンなPR一覧を取得
    * `gh pr view [pr-number]` で各PRの詳細を確認
    * ラベル、コメント、作成日時、作成者などの情報も収集してください

3. **PR の評価と優先度判定**:
    取得したPRを以下の観点で評価し、レビューの優先度を判定してください:
    * **緊急性**: `critical`, `hotfix`, `urgent` などのラベル
    * **影響範囲**: 変更されるファイル数、コード行数
    * **変更の種類**: `feat`, `fix`, `refactor`, `docs` などの変更タイプ
    * **作成日時**: 長期間レビュー待ちのPRを優先
    * **依存関係**: 他のPRや機能との関連性
    * **作成者**: 新規コントリビューターのPRを優先考慮

4. **レビュー対象PRの選定**:
    評価結果を基に、以下の優先順位でレビュー対象PRを選定してください:
    * **第一優先**: 緊急性が高く、影響範囲が大きいPR
    * **第二優先**: 長期間レビュー待ちのPR
    * **第三優先**: 新規コントリビューターまたは学習価値の高いPR

5. **Discordへの通知**:
    レビュー開始前に、MCP経由でチャンネルID `1389372596273025135` にレビューするPRの要約を**日本語**で簡潔に投稿してください。PR番号、タイトル、概要を中立的かつ俯瞰的に記述し、褒め称える表現や主観的評価は避けてください。事実ベースの簡潔な報告を心がけてください。

6. **詳細なコードレビュー**:
    選定したPRに対して、以下の観点で包括的なレビューを実施してください:
    * **機能性**: 実装が要求仕様を満たしているか
    * **コードの品質**: 可読性、保守性、効率性
    * **設計**: アーキテクチャの一貫性、設計パターンの適用
    * **テスト**: テストカバレッジ、テストケースの妥当性
    * **セキュリティ**: セキュリティリスクの有無
    * **パフォーマンス**: 実行効率、メモリ使用量
    * **ドキュメント**: コメント、READMEの更新状況

7. **変更内容の詳細分析**:
    PRの変更内容を以下の手順で詳細に分析してください:
    * `gh pr diff [pr-number]` で変更差分を確認
    * `gh pr checkout [pr-number]` でローカルにチェックアウト
    * 実際にコードを実行し、動作確認を実施
    * 関連するテストを実行し、既存機能への影響を確認

8. **建設的なフィードバック**:
    レビュー結果を基に、以下の形式で**英語**での建設的なフィードバックを提供してください:
    * **肯定的な点**: 良い実装や改善点を具体的に評価
    * **改善提案**: 具体的な改善案と理由を明記
    * **質問**: 設計判断の背景や意図を確認
    * **学習リソース**: 必要に応じて参考資料やベストプラクティスを提示

9. **レビューコメントの投稿**:
    GitHub CLI を使用して**英語**でレビューコメントを投稿してください:
    * `gh pr review [pr-number] --approve` (承認の場合)
    * `gh pr review [pr-number] --request-changes` (変更要求の場合)
    * `gh pr review [pr-number] --comment` (コメントのみの場合)
    * 行単位のコメントは GitHub Web UI で英語で追加

10. **フォローアップ**:
    レビュー後の適切なフォローアップを**英語**で実施してください:
    * 作成者からの質問や反応への迅速な回答
    * 修正内容の再レビュー
    * 必要に応じて追加のテストやドキュメント作成の支援

11. **マージの判断**:
    すべてのレビュー観点をクリアしたPRについて、マージの適切性を判断してください:
    * CIの実行状況確認
    * 他のレビュアーの承認状況確認
    * マージ方式の選択（merge、squash、rebase）
    * `gh pr merge [pr-number] --squash` などでマージ実行

**今回限定の特記事項**:

```markdown
$ARGUMENTS
```

**厳守しなさい**:

* 自己宣伝を含むレビューコメントを使用しないこと。(例: 「私の素晴らしいレビュー」、「このレビューはClaudeによって実施されました」など)
* 非感情的で、事実に基づいた中立的な表現を使用すること。
* 建設的で教育的なフィードバックを提供すること。
* 作成者の学習と成長を支援する姿勢を持つこと。
* コードの品質と保守性を最優先に判断すること。
* プロジェクトの一貫性とベストプラクティスを重視すること。
